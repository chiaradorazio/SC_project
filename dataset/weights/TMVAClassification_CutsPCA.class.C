// Class: ReadCutsPCA
// Automatically generated by MethodBase::MakeClass
//

/* configuration options =====================================================

#GEN -*-*-*-*-*-*-*-*-*-*-*- general info -*-*-*-*-*-*-*-*-*-*-*-

Method         : Cuts::CutsPCA
TMVA Release   : 4.2.1         [262657]
ROOT Release   : 6.26/06       [399878]
Creator        : chiara
Date           : Thu Apr  6 16:46:15 2023
Host           : Linux chiara 5.15.0-48-generic #54-Ubuntu SMP Fri Aug 26 13:26:29 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
Dir            : /home/chiara/Documenti/SC
Training events: 2000
Analysis type  : [Classification]


#OPT -*-*-*-*-*-*-*-*-*-*-*-*- options -*-*-*-*-*-*-*-*-*-*-*-*-

# Set by User:
V: "False" [Verbose output (short form of "VerbosityLevel" below - overrides the latter one)]
VarTransform: "PCA" [List of variable transformations performed before training, e.g., "D_Background,P_Signal,G,N_AllClasses" for: "Decorrelation, PCA-transformation, Gaussianisation, Normalisation, each for the given class of events ('AllClasses' denotes all events of all classes, if no class indication is given, 'All' is assumed)"]
H: "False" [Print method-specific help message]
FitMethod: "MC" [Minimisation Method (GA, SA, and MC are the primary methods to be used; the others have been introduced for testing purposes and are depreciated)]
EffMethod: "EffSel" [Selection Method]
# Default:
VerbosityLevel: "Default" [Verbosity level]
CreateMVAPdfs: "False" [Create PDFs for classifier outputs (signal and background)]
IgnoreNegWeightsInTraining: "False" [Events with negative weights are ignored in the training (but are included for testing and performance evaluation)]
CutRangeMin[0]: "-1.000000e+00" [Minimum of allowed cut range (set per variable)]
    CutRangeMin[1]: "-1.000000e+00"
    CutRangeMin[2]: "-1.000000e+00"
    CutRangeMin[3]: "-1.000000e+00"
    CutRangeMin[4]: "-1.000000e+00"
    CutRangeMin[5]: "-1.000000e+00"
    CutRangeMin[6]: "-1.000000e+00"
    CutRangeMin[7]: "-1.000000e+00"
    CutRangeMin[8]: "-1.000000e+00"
    CutRangeMin[9]: "-1.000000e+00"
CutRangeMax[0]: "-1.000000e+00" [Maximum of allowed cut range (set per variable)]
    CutRangeMax[1]: "-1.000000e+00"
    CutRangeMax[2]: "-1.000000e+00"
    CutRangeMax[3]: "-1.000000e+00"
    CutRangeMax[4]: "-1.000000e+00"
    CutRangeMax[5]: "-1.000000e+00"
    CutRangeMax[6]: "-1.000000e+00"
    CutRangeMax[7]: "-1.000000e+00"
    CutRangeMax[8]: "-1.000000e+00"
    CutRangeMax[9]: "-1.000000e+00"
VarProp[0]: "FSmart" [Categorisation of cuts]
    VarProp[1]: "FSmart"
    VarProp[2]: "FSmart"
    VarProp[3]: "FSmart"
    VarProp[4]: "FSmart"
    VarProp[5]: "FSmart"
    VarProp[6]: "FSmart"
    VarProp[7]: "FSmart"
    VarProp[8]: "FSmart"
    VarProp[9]: "FSmart"
##


#VAR -*-*-*-*-*-*-*-*-*-*-*-* variables *-*-*-*-*-*-*-*-*-*-*-*-

NVar 10
Length                        Length                        Length                        Length                                                          'F'    [8.05179977417,305.096099854]
Width                         Width                         Width                         Width                                                           'F'    [0,256.381988525]
Size                          Size                          Size                          Size                                                            'F'    [1.99779999256,5.179500103]
Conc                          Conc                          Conc                          Conc                                                            'F'    [0.0137000000104,0.884599983692]
Conl                          Conl                          Conl                          Conl                                                            'F'    [0.00719999987632,0.615899980068]
Asym                          Asym                          Asym                          Asym                                                            'F'    [-343.357696533,464.631011963]
M3Long                        M3Long                        M3Long                        M3Long                                                          'F'    [-318.300201416,217.934005737]
M3Trans                       M3Trans                       M3Trans                       M3Trans                                                         'F'    [-149.551300049,154.865005493]
Alpha                         Alpha                         Alpha                         Alpha                                                           'F'    [0.00899999961257,89.8863983154]
Dist                          Dist                          Dist                          Dist                                                            'F'    [5.6998000145,495.561004639]
NSpec 0


============================================================================ */

#include <array>
#include <vector>
#include <cmath>
#include <string>
#include <iostream>

#ifndef IClassifierReader__def
#define IClassifierReader__def

class IClassifierReader {

 public:

   // constructor
   IClassifierReader() : fStatusIsClean( true ) {}
   virtual ~IClassifierReader() {}

   // return classifier response
   virtual double GetMvaValue( const std::vector<double>& inputValues ) const = 0;

   // returns classifier status
   bool IsStatusClean() const { return fStatusIsClean; }

 protected:

   bool fStatusIsClean;
};

#endif

class ReadCutsPCA : public IClassifierReader {

 public:

   // constructor
   ReadCutsPCA( std::vector<std::string>& theInputVars )
      : IClassifierReader(),
        fClassName( "ReadCutsPCA" ),
        fNvars( 10 )
   {
      // the training input variables
      const char* inputVars[] = { "Length", "Width", "Size", "Conc", "Conl", "Asym", "M3Long", "M3Trans", "Alpha", "Dist" };

      // sanity checks
      if (theInputVars.size() <= 0) {
         std::cout << "Problem in class \"" << fClassName << "\": empty input vector" << std::endl;
         fStatusIsClean = false;
      }

      if (theInputVars.size() != fNvars) {
         std::cout << "Problem in class \"" << fClassName << "\": mismatch in number of input values: "
                   << theInputVars.size() << " != " << fNvars << std::endl;
         fStatusIsClean = false;
      }

      // validate input variables
      for (size_t ivar = 0; ivar < theInputVars.size(); ivar++) {
         if (theInputVars[ivar] != inputVars[ivar]) {
            std::cout << "Problem in class \"" << fClassName << "\": mismatch in input variable names" << std::endl
                      << " for variable [" << ivar << "]: " << theInputVars[ivar].c_str() << " != " << inputVars[ivar] << std::endl;
            fStatusIsClean = false;
         }
      }

      // initialize min and max vectors (for normalisation)
      fVmin[0] = -187.147903442383;
      fVmax[0] = 341.509460449219;
      fVmin[1] = -289.180236816406;
      fVmax[1] = 338.697021484375;
      fVmin[2] = -344.859161376953;
      fVmax[2] = 524.637512207031;
      fVmin[3] = -83.434944152832;
      fVmax[3] = 348.046539306641;
      fVmin[4] = -71.7563323974609;
      fVmax[4] = 68.7341537475586;
      fVmin[5] = -160.467742919922;
      fVmax[5] = 148.830276489258;
      fVmin[6] = -54.7469177246094;
      fVmax[6] = 151.163269042969;
      fVmin[7] = -0.996643006801605;
      fVmax[7] = 2.19814538955688;
      fVmin[8] = -0.455651313066483;
      fVmax[8] = 0.225584730505943;
      fVmin[9] = -0.1511440128088;
      fVmax[9] = 0.0827660262584686;

      // initialize input variable types
      fType[0] = 'F';
      fType[1] = 'F';
      fType[2] = 'F';
      fType[3] = 'F';
      fType[4] = 'F';
      fType[5] = 'F';
      fType[6] = 'F';
      fType[7] = 'F';
      fType[8] = 'F';
      fType[9] = 'F';

      // initialize constants
      Initialize();

      // initialize transformation
      InitTransform();
   }

   // destructor
   virtual ~ReadCutsPCA() {
      Clear(); // method-specific
   }

   // the classifier response
   // "inputValues" is a vector of input values in the same order as the
   // variables given to the constructor
   double GetMvaValue( const std::vector<double>& inputValues ) const override;

 private:

   // method-specific destructor
   void Clear();

   // input variable transformation

   void X2P_1( const double*, double*, int ) const;
   double fMeanValues_1[3][10];
   double fEigenVectors_1[3][10][10];

   void InitTransform_1();
   void Transform_1( std::vector<double> & iv, int sigOrBgd ) const;
   void InitTransform();
   void Transform( std::vector<double> & iv, int sigOrBgd ) const;

   // common member variables
   const char* fClassName;

   const size_t fNvars;
   size_t GetNvar()           const { return fNvars; }
   char   GetType( int ivar ) const { return fType[ivar]; }

   // normalisation of input variables
   double fVmin[10];
   double fVmax[10];
   double NormVariable( double x, double xmin, double xmax ) const {
      // normalise to output range: [-1, 1]
      return 2*(x - xmin)/(xmax - xmin) - 1.0;
   }

   // type of input variable: 'F' or 'I'
   char   fType[10];

   // initialize internal variables
   void Initialize();
   double GetMvaValue__( const std::vector<double>& inputValues ) const;

   // private members (method specific)
   // not implemented for class: "ReadCutsPCA"
};
inline double ReadCutsPCA::GetMvaValue( const std::vector<double>& inputValues ) const
{
   // classifier response value
   double retval = 0;

   // classifier response, sanity check first
   if (!IsStatusClean()) {
      std::cout << "Problem in class \"" << fClassName << "\": cannot return classifier response"
                << " because status is dirty" << std::endl;
   }
   else {
         std::vector<double> iV(inputValues);
         Transform( iV, -1 );
         retval = GetMvaValue__( iV );
   }

   return retval;
}

//_______________________________________________________________________
inline void ReadCutsPCA::X2P_1( const double* x, double* p, int index ) const
{
   // Calculate the principal components from the original data vector
   // x, and return it in p (function extracted from TPrincipal::X2P)
   // It's the users responsibility to make sure that both x and p are
   // of the right size (i.e., memory must be allocated for p).
   const int nVar = 10;

   for (int i = 0; i < nVar; i++) {
      p[i] = 0;
      for (int j = 0; j < nVar; j++) p[i] += (x[j] - fMeanValues_1[index][j]) * fEigenVectors_1[index][j][i];
   }
}

//_______________________________________________________________________
inline void ReadCutsPCA::InitTransform_1()
{
   // PCA transformation, initialisation
   // initialise vector of mean values
   fMeanValues_1[0][0] = 44.4623441429;
   fMeanValues_1[0][1] = 18.8538346767;
   fMeanValues_1[0][2] = 2.78702849853;
   fMeanValues_1[0][3] = 0.379297200147;
   fMeanValues_1[0][4] = 0.211773699887;
   fMeanValues_1[0][5] = 4.18219939099;
   fMeanValues_1[0][6] = 17.8668861318;
   fMeanValues_1[0][7] = 0.268044993043;
   fMeanValues_1[0][8] = 19.6266200065;
   fMeanValues_1[0][9] = 193.283750069;
   fMeanValues_1[1][0] = 69.8603422918;
   fMeanValues_1[1][1] = 29.1523241508;
   fMeanValues_1[1][2] = 2.9010419004;
   fMeanValues_1[1][3] = 0.373505099299;
   fMeanValues_1[1][4] = 0.212705399974;
   fMeanValues_1[1][5] = -16.6140081801;
   fMeanValues_1[1][6] = -2.35377470327;
   fMeanValues_1[1][7] = 2.37178841145;
   fMeanValues_1[1][8] = 43.4415856964;
   fMeanValues_1[1][9] = 199.86501817;
   fMeanValues_1[2][0] = 57.1613432174;
   fMeanValues_1[2][1] = 24.0030794138;
   fMeanValues_1[2][2] = 2.84403519946;
   fMeanValues_1[2][3] = 0.376401149723;
   fMeanValues_1[2][4] = 0.212239549931;
   fMeanValues_1[2][5] = -6.21590439455;
   fMeanValues_1[2][6] = 7.75655571425;
   fMeanValues_1[2][7] = 1.31991670224;
   fMeanValues_1[2][8] = 31.5341028514;
   fMeanValues_1[2][9] = 196.574384119;

   // initialise matrix of eigenvectors
   fEigenVectors_1[0][0][0] = 0.235325136242;
   fEigenVectors_1[0][0][1] = 0.152685035736;
   fEigenVectors_1[0][0][2] = -0.313178798158;
   fEigenVectors_1[0][0][3] = -0.533343029126;
   fEigenVectors_1[0][0][4] = 0.6914407131;
   fEigenVectors_1[0][0][5] = -0.0792004108375;
   fEigenVectors_1[0][0][6] = -0.233231384653;
   fEigenVectors_1[0][0][7] = 0.0036325627728;
   fEigenVectors_1[0][0][8] = -0.000750425290148;
   fEigenVectors_1[0][0][9] = 0.000107403362006;
   fEigenVectors_1[0][1][0] = 0.0522020544658;
   fEigenVectors_1[0][1][1] = 0.0551530516687;
   fEigenVectors_1[0][1][2] = -0.0841813946382;
   fEigenVectors_1[0][1][3] = -0.121712795802;
   fEigenVectors_1[0][1][4] = 0.157414114898;
   fEigenVectors_1[0][1][5] = -0.0678338121609;
   fEigenVectors_1[0][1][6] = 0.970402835557;
   fEigenVectors_1[0][1][7] = 0.0356407132774;
   fEigenVectors_1[0][1][8] = 6.70718388053e-05;
   fEigenVectors_1[0][1][9] = -0.000129209665579;
   fEigenVectors_1[0][2][0] = 0.00311222691633;
   fEigenVectors_1[0][2][1] = 0.00373125107519;
   fEigenVectors_1[0][2][2] = -0.00476380726863;
   fEigenVectors_1[0][2][3] = -0.00762394681469;
   fEigenVectors_1[0][2][4] = 0.00510530730089;
   fEigenVectors_1[0][2][5] = -0.00233910560955;
   fEigenVectors_1[0][2][6] = 0.0318057046728;
   fEigenVectors_1[0][2][7] = -0.939888193025;
   fEigenVectors_1[0][2][8] = -0.339083434948;
   fEigenVectors_1[0][2][9] = 0.0220237079925;
   fEigenVectors_1[0][3][0] = -0.000983615624909;
   fEigenVectors_1[0][3][1] = -0.00128899358242;
   fEigenVectors_1[0][3][2] = 0.00172525869284;
   fEigenVectors_1[0][3][3] = 0.00358347874736;
   fEigenVectors_1[0][3][4] = -0.00153195974821;
   fEigenVectors_1[0][3][5] = 0.000628707425616;
   fEigenVectors_1[0][3][6] = -0.00971829513218;
   fEigenVectors_1[0][3][7] = 0.295762617125;
   fEigenVectors_1[0][3][8] = -0.785583120597;
   fEigenVectors_1[0][3][9] = 0.543385683166;
   fEigenVectors_1[0][4][0] = -0.000557873087896;
   fEigenVectors_1[0][4][1] = -0.000739233554159;
   fEigenVectors_1[0][4][2] = 0.000953563068291;
   fEigenVectors_1[0][4][3] = 0.00200361928038;
   fEigenVectors_1[0][4][4] = -0.000842433633941;
   fEigenVectors_1[0][4][5] = 0.000321494993209;
   fEigenVectors_1[0][4][6] = -0.005638366153;
   fEigenVectors_1[0][4][7] = 0.166837839484;
   fEigenVectors_1[0][4][8] = -0.51757108513;
   fEigenVectors_1[0][4][9] = -0.839194209624;
   fEigenVectors_1[0][5][0] = -0.0928086263962;
   fEigenVectors_1[0][5][1] = 0.808882863694;
   fEigenVectors_1[0][5][2] = 0.57242261158;
   fEigenVectors_1[0][5][3] = -0.0176666619643;
   fEigenVectors_1[0][5][4] = 0.0948775656019;
   fEigenVectors_1[0][5][5] = -0.00518188967542;
   fEigenVectors_1[0][5][6] = -0.00930507542108;
   fEigenVectors_1[0][5][7] = 0.00035383208385;
   fEigenVectors_1[0][5][8] = 1.39289524019e-05;
   fEigenVectors_1[0][5][9] = -1.55379362854e-05;
   fEigenVectors_1[0][6][0] = 0.135694589148;
   fEigenVectors_1[0][6][1] = 0.552044179819;
   fEigenVectors_1[0][6][2] = -0.710176186637;
   fEigenVectors_1[0][6][3] = 0.347810792226;
   fEigenVectors_1[0][6][4] = -0.22465341712;
   fEigenVectors_1[0][6][5] = 0.0264789830862;
   fEigenVectors_1[0][6][6] = -0.0184179585296;
   fEigenVectors_1[0][6][7] = 0.00144664862827;
   fEigenVectors_1[0][6][8] = 0.000173827128535;
   fEigenVectors_1[0][6][9] = -1.32315376356e-05;
   fEigenVectors_1[0][7][0] = 0.00299391023665;
   fEigenVectors_1[0][7][1] = 0.00638793720953;
   fEigenVectors_1[0][7][2] = 0.00535917620907;
   fEigenVectors_1[0][7][3] = -0.0224857744274;
   fEigenVectors_1[0][7][4] = -0.146718874503;
   fEigenVectors_1[0][7][5] = -0.987710938781;
   fEigenVectors_1[0][7][6] = -0.0481303248135;
   fEigenVectors_1[0][7][7] = 0.000195265256149;
   fEigenVectors_1[0][7][8] = 7.85244457674e-05;
   fEigenVectors_1[0][7][9] = 2.74475441681e-05;
   fEigenVectors_1[0][8][0] = -0.149416113374;
   fEigenVectors_1[0][8][1] = -0.105904685487;
   fEigenVectors_1[0][8][2] = 0.040242287771;
   fEigenVectors_1[0][8][3] = 0.732997573984;
   fEigenVectors_1[0][8][4] = 0.643996795293;
   fEigenVectors_1[0][8][5] = -0.113135171697;
   fEigenVectors_1[0][8][6] = -0.00275284263148;
   fEigenVectors_1[0][8][7] = -0.00375007486008;
   fEigenVectors_1[0][8][8] = 0.00102619409632;
   fEigenVectors_1[0][8][9] = -6.13600991177e-05;
   fEigenVectors_1[0][9][0] = 0.944735656145;
   fEigenVectors_1[0][9][1] = -0.0576924496747;
   fEigenVectors_1[0][9][2] = 0.247264895834;
   fEigenVectors_1[0][9][3] = 0.203913502728;
   fEigenVectors_1[0][9][4] = -0.0370432879259;
   fEigenVectors_1[0][9][5] = 0.00440960478597;
   fEigenVectors_1[0][9][6] = 0.00580575042455;
   fEigenVectors_1[0][9][7] = -0.000138224188028;
   fEigenVectors_1[0][9][8] = 0.000315163919078;
   fEigenVectors_1[0][9][9] = -3.13851431764e-05;
   fEigenVectors_1[1][0][0] = 0.366605853005;
   fEigenVectors_1[1][0][1] = 0.034922155755;
   fEigenVectors_1[1][0][2] = 0.120264748717;
   fEigenVectors_1[1][0][3] = -0.844982230007;
   fEigenVectors_1[1][0][4] = 0.0352877981585;
   fEigenVectors_1[1][0][5] = 0.0466202056533;
   fEigenVectors_1[1][0][6] = -0.363990776894;
   fEigenVectors_1[1][0][7] = 0.00372843694976;
   fEigenVectors_1[1][0][8] = -0.000391147218664;
   fEigenVectors_1[1][0][9] = 2.43540270024e-05;
   fEigenVectors_1[1][1][0] = 0.167367347038;
   fEigenVectors_1[1][1][1] = -0.0157694223722;
   fEigenVectors_1[1][1][2] = 0.0953253376343;
   fEigenVectors_1[1][1][3] = -0.318698228879;
   fEigenVectors_1[1][1][4] = -0.0400871881854;
   fEigenVectors_1[1][1][5] = -0.108878225275;
   fEigenVectors_1[1][1][6] = 0.920634405349;
   fEigenVectors_1[1][1][7] = 0.00736874659667;
   fEigenVectors_1[1][1][8] = 0.000747002284868;
   fEigenVectors_1[1][1][9] = -5.65872560628e-06;
   fEigenVectors_1[1][2][0] = 0.00266984018079;
   fEigenVectors_1[1][2][1] = -0.000703342329541;
   fEigenVectors_1[1][2][2] = 0.000754558595733;
   fEigenVectors_1[1][2][3] = -0.0049295830478;
   fEigenVectors_1[1][2][4] = -0.000588515474552;
   fEigenVectors_1[1][2][5] = -0.000913946603975;
   fEigenVectors_1[1][2][6] = 0.00522416992286;
   fEigenVectors_1[1][2][7] = -0.913267334729;
   fEigenVectors_1[1][2][8] = -0.406699568401;
   fEigenVectors_1[1][2][9] = 0.0218465076102;
   fEigenVectors_1[1][3][0] = -0.000814241100385;
   fEigenVectors_1[1][3][1] = 0.000200138369844;
   fEigenVectors_1[1][3][2] = -0.000139168961977;
   fEigenVectors_1[1][3][3] = 0.00210947125456;
   fEigenVectors_1[1][3][4] = 0.0002025851103;
   fEigenVectors_1[1][3][5] = 0.000248487429099;
   fEigenVectors_1[1][3][6] = -0.00125246448457;
   fEigenVectors_1[1][3][7] = 0.350405024715;
   fEigenVectors_1[1][3][8] = -0.757300204432;
   fEigenVectors_1[1][3][9] = 0.55109515992;
   fEigenVectors_1[1][4][0] = -0.000466325055924;
   fEigenVectors_1[1][4][1] = 0.000110610883509;
   fEigenVectors_1[1][4][2] = -8.79671204003e-05;
   fEigenVectors_1[1][4][3] = 0.00123581205404;
   fEigenVectors_1[1][4][4] = 0.000139283194539;
   fEigenVectors_1[1][4][5] = 0.000158697485608;
   fEigenVectors_1[1][4][6] = -0.000703584107118;
   fEigenVectors_1[1][4][7] = 0.207580810015;
   fEigenVectors_1[1][4][8] = -0.510970693514;
   fEigenVectors_1[1][4][9] = -0.834156372273;
   fEigenVectors_1[1][5][0] = -0.610333230929;
   fEigenVectors_1[1][5][1] = -0.497372058254;
   fEigenVectors_1[1][5][2] = 0.58477810578;
   fEigenVectors_1[1][5][3] = -0.19157897126;
   fEigenVectors_1[1][5][4] = -0.00480388598671;
   fEigenVectors_1[1][5][5] = 0.0313898966955;
   fEigenVectors_1[1][5][6] = -0.0209293879022;
   fEigenVectors_1[1][5][7] = 8.22435603421e-07;
   fEigenVectors_1[1][5][8] = -7.37915183587e-05;
   fEigenVectors_1[1][5][9] = -2.01871720609e-06;
   fEigenVectors_1[1][6][0] = -0.372743199891;
   fEigenVectors_1[1][6][1] = -0.362735105797;
   fEigenVectors_1[1][6][2] = -0.79504590123;
   fEigenVectors_1[1][6][3] = -0.306847587425;
   fEigenVectors_1[1][6][4] = -0.0260799995367;
   fEigenVectors_1[1][6][5] = -0.0391896106952;
   fEigenVectors_1[1][6][6] = 0.0318748384674;
   fEigenVectors_1[1][6][7] = 0.000526076282712;
   fEigenVectors_1[1][6][8] = -0.000220581826209;
   fEigenVectors_1[1][6][9] = 1.68610541293e-05;
   fEigenVectors_1[1][7][0] = 0.0299079491705;
   fEigenVectors_1[1][7][1] = -0.00133789352039;
   fEigenVectors_1[1][7][2] = 0.0176009007977;
   fEigenVectors_1[1][7][3] = -0.00373108323366;
   fEigenVectors_1[1][7][4] = -0.997887068071;
   fEigenVectors_1[1][7][5] = 0.0241502303778;
   fEigenVectors_1[1][7][6] = -0.0491727290032;
   fEigenVectors_1[1][7][7] = 0.000468789917613;
   fEigenVectors_1[1][7][8] = -1.89694297932e-05;
   fEigenVectors_1[1][7][9] = -1.65539507303e-05;
   fEigenVectors_1[1][8][0] = -0.0130197475732;
   fEigenVectors_1[1][8][1] = 0.0129951546252;
   fEigenVectors_1[1][8][2] = 0.0455480225806;
   fEigenVectors_1[1][8][3] = -0.0020083573317;
   fEigenVectors_1[1][8][4] = -0.0176333840391;
   fEigenVectors_1[1][8][5] = -0.991298466818;
   fEigenVectors_1[1][8][6] = -0.120827453641;
   fEigenVectors_1[1][8][7] = 0.000309698912295;
   fEigenVectors_1[1][8][8] = 5.78721091926e-06;
   fEigenVectors_1[1][8][9] = -1.48769669522e-05;
   fEigenVectors_1[1][9][0] = 0.570151002896;
   fEigenVectors_1[1][9][1] = -0.787022767182;
   fEigenVectors_1[1][9][2] = 0.0010205993768;
   fEigenVectors_1[1][9][3] = 0.231366145697;
   fEigenVectors_1[1][9][4] = 0.0188308603323;
   fEigenVectors_1[1][9][5] = -0.013933094173;
   fEigenVectors_1[1][9][6] = -0.0379786115995;
   fEigenVectors_1[1][9][7] = 0.000713570134812;
   fEigenVectors_1[1][9][8] = 0.000215166546948;
   fEigenVectors_1[1][9][9] = -2.13533056042e-06;
   fEigenVectors_1[2][0][0] = 0.335938841542;
   fEigenVectors_1[2][0][1] = 0.0937974106216;
   fEigenVectors_1[2][0][2] = 0.0498108751501;
   fEigenVectors_1[2][0][3] = 0.86453857176;
   fEigenVectors_1[2][0][4] = 0.0696680385459;
   fEigenVectors_1[2][0][5] = -0.0389074866446;
   fEigenVectors_1[2][0][6] = -0.349362800617;
   fEigenVectors_1[2][0][7] = 0.00413985351443;
   fEigenVectors_1[2][0][8] = -0.000375496797041;
   fEigenVectors_1[2][0][9] = 3.47606597244e-05;
   fEigenVectors_1[2][1][0] = 0.136972544838;
   fEigenVectors_1[2][1][1] = 0.0428460542741;
   fEigenVectors_1[2][1][2] = 0.0696183075155;
   fEigenVectors_1[2][1][3] = 0.320702758164;
   fEigenVectors_1[2][1][4] = -0.0565494145799;
   fEigenVectors_1[2][1][5] = 0.0417039494185;
   fEigenVectors_1[2][1][6] = 0.930950863034;
   fEigenVectors_1[2][1][7] = 0.00994672781334;
   fEigenVectors_1[2][1][8] = 0.00051579859497;
   fEigenVectors_1[2][1][9] = -3.53058889558e-05;
   fEigenVectors_1[2][2][0] = 0.00281298752543;
   fEigenVectors_1[2][2][1] = -0.000719902430917;
   fEigenVectors_1[2][2][2] = -1.97961857537e-05;
   fEigenVectors_1[2][2][3] = 0.0062641759004;
   fEigenVectors_1[2][2][4] = 0.00149092682238;
   fEigenVectors_1[2][2][5] = 0.000793264875503;
   fEigenVectors_1[2][2][6] = 0.00763383700803;
   fEigenVectors_1[2][2][7] = -0.927354314364;
   fEigenVectors_1[2][2][8] = -0.373346202554;
   fEigenVectors_1[2][2][9] = 0.022754991092;
   fEigenVectors_1[2][3][0] = -0.000836594590777;
   fEigenVectors_1[2][3][1] = 0.000281828713948;
   fEigenVectors_1[2][3][2] = 0.000154498054033;
   fEigenVectors_1[2][3][3] = -0.00241140635171;
   fEigenVectors_1[2][3][4] = -0.00106439370426;
   fEigenVectors_1[2][3][5] = -0.000258005257991;
   fEigenVectors_1[2][3][6] = -0.0021362729825;
   fEigenVectors_1[2][3][7] = 0.323881613031;
   fEigenVectors_1[2][3][8] = -0.77118161532;
   fEigenVectors_1[2][3][9] = 0.548057693771;
   fEigenVectors_1[2][4][0] = -0.000472218770256;
   fEigenVectors_1[2][4][1] = 0.000165019893535;
   fEigenVectors_1[2][4][2] = 8.20549338447e-05;
   fEigenVectors_1[2][4][3] = -0.00138407562144;
   fEigenVectors_1[2][4][4] = -0.000629177164261;
   fEigenVectors_1[2][4][5] = -0.00016090644654;
   fEigenVectors_1[2][4][6] = -0.00124307857293;
   fEigenVectors_1[2][4][7] = 0.18705648288;
   fEigenVectors_1[2][4][8] = -0.515645964874;
   fEigenVectors_1[2][4][9] = -0.836130953561;
   fEigenVectors_1[2][5][0] = -0.456209215585;
   fEigenVectors_1[2][5][1] = -0.628900179508;
   fEigenVectors_1[2][5][2] = 0.595357835383;
   fEigenVectors_1[2][5][3] = 0.203810244217;
   fEigenVectors_1[2][5][4] = -0.00123886828326;
   fEigenVectors_1[2][5][5] = 0.00314101151767;
   fEigenVectors_1[2][5][6] = -0.018884632035;
   fEigenVectors_1[2][5][7] = 0.00033799892681;
   fEigenVectors_1[2][5][8] = -6.07957543025e-05;
   fEigenVectors_1[2][5][9] = -3.9038294031e-06;
   fEigenVectors_1[2][6][0] = -0.204486120717;
   fEigenVectors_1[2][6][1] = -0.531777666866;
   fEigenVectors_1[2][6][2] = -0.788133641066;
   fEigenVectors_1[2][6][3] = 0.205953817932;
   fEigenVectors_1[2][6][4] = -0.100534997684;
   fEigenVectors_1[2][6][5] = 0.0214248193685;
   fEigenVectors_1[2][6][6] = 0.035468597082;
   fEigenVectors_1[2][6][7] = 0.00140641704478;
   fEigenVectors_1[2][6][8] = -0.000141274182011;
   fEigenVectors_1[2][6][9] = 1.28280696125e-05;
   fEigenVectors_1[2][7][0] = 0.0223013212389;
   fEigenVectors_1[2][7][1] = 0.0120488247495;
   fEigenVectors_1[2][7][2] = 0.0180700814783;
   fEigenVectors_1[2][7][3] = 0.013533186796;
   fEigenVectors_1[2][7][4] = -0.0303627969175;
   fEigenVectors_1[2][7][5] = 0.997370132885;
   fEigenVectors_1[2][7][6] = -0.0563780322189;
   fEigenVectors_1[2][7][7] = 0.000487721955443;
   fEigenVectors_1[2][7][8] = 4.01345573307e-06;
   fEigenVectors_1[2][7][9] = -9.47982080824e-06;
   fEigenVectors_1[2][8][0] = -0.0303042274725;
   fEigenVectors_1[2][8][1] = 0.105389998515;
   fEigenVectors_1[2][8][2] = 0.0692053323028;
   fEigenVectors_1[2][8][3] = 0.0425146504405;
   fEigenVectors_1[2][8][4] = -0.986838899377;
   fEigenVectors_1[2][8][5] = -0.036903484636;
   fEigenVectors_1[2][8][6] = -0.0784789897718;
   fEigenVectors_1[2][8][7] = -0.00236830628738;
   fEigenVectors_1[2][8][8] = 0.000535628374112;
   fEigenVectors_1[2][8][9] = -1.94643860909e-05;
   fEigenVectors_1[2][9][0] = 0.785504719172;
   fEigenVectors_1[2][9][1] = -0.547549529949;
   fEigenVectors_1[2][9][2] = 0.109318995537;
   fEigenVectors_1[2][9][3] = -0.252447212273;
   fEigenVectors_1[2][9][4] = -0.0840419129995;
   fEigenVectors_1[2][9][5] = -0.0129741424021;
   fEigenVectors_1[2][9][6] = -0.0161138055359;
   fEigenVectors_1[2][9][7] = 0.000730617564729;
   fEigenVectors_1[2][9][8] = 0.000224780263654;
   fEigenVectors_1[2][9][9] = -8.55742079411e-06;
}

//_______________________________________________________________________
inline void ReadCutsPCA::Transform_1( std::vector<double>& iv, int cls ) const
{
   // PCA transformation
   const int nVar = 10;
   double *dv = new double[nVar];
   double *rv = new double[nVar];
   if (cls < 0 || cls > 2) {
       if (2 > 1 ) cls = 2;
       else cls = 2;
   }

   // define the indices of the variables which are transformed by this transformation
   static std::vector<int> indicesGet;
   static std::vector<int> indicesPut;

   if ( indicesGet.empty() ) {
      indicesGet.reserve(fNvars);
      indicesGet.push_back( 0);
      indicesGet.push_back( 1);
      indicesGet.push_back( 2);
      indicesGet.push_back( 3);
      indicesGet.push_back( 4);
      indicesGet.push_back( 5);
      indicesGet.push_back( 6);
      indicesGet.push_back( 7);
      indicesGet.push_back( 8);
      indicesGet.push_back( 9);
   }
   if ( indicesPut.empty() ) {
      indicesPut.reserve(fNvars);
      indicesPut.push_back( 0);
      indicesPut.push_back( 1);
      indicesPut.push_back( 2);
      indicesPut.push_back( 3);
      indicesPut.push_back( 4);
      indicesPut.push_back( 5);
      indicesPut.push_back( 6);
      indicesPut.push_back( 7);
      indicesPut.push_back( 8);
      indicesPut.push_back( 9);
   }

   for (int ivar=0; ivar<nVar; ivar++) dv[ivar] = iv[indicesGet.at(ivar)];

   // Perform PCA and put it into PCAed events tree
   this->X2P_1( dv, rv, cls );
   for (int ivar=0; ivar<nVar; ivar++) iv[indicesPut.at(ivar)] = rv[ivar];

   delete [] dv;
   delete [] rv;
}

//_______________________________________________________________________
inline void ReadCutsPCA::InitTransform()
{
   InitTransform_1();
}

//_______________________________________________________________________
inline void ReadCutsPCA::Transform( std::vector<double>& iv, int sigOrBgd ) const
{
   Transform_1( iv, sigOrBgd );
}
